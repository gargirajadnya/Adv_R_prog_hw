#load libraries
suppressMessages({
library(reshape2)
library(dplyr)
})
#loading USArrests dataset
USArrests <- as.data.frame(USArrests)
head(USArrests)
#summary
summary(USArrests)
#correlation matrix
corr_matrix <- round(cor(USArrests),2)
head(corr_matrix)
#melting with the library "reshape"
melted_corr_matrix <- melt(corr_matrix)
melted_corr_matrix <- melted_corr_matrix %>% rename(Var1 = Var1, Var2 = Var2, corr = value)
head(melted_corr_matrix)
#plotting the correlation on a heatmap
library(ggplot2)
ggplot(data = melted_corr_matrix, aes(x=Var1,
y=Var2,
fill=corr)) +
geom_tile() + geom_text(aes(Var2,
Var1,
label = corr),
color = "aliceblue", size = 4)
#standardizing the data
scaled_df <- scale(USArrests)
head(scaled_df)
#determining optimal number of clusters by elbow method
opt_clust <- fviz_nbclust(scaled_df, kmeans, method = "wss")
#load libraries
suppressMessages({
library(reshape2)
library(dplyr)
library(factoextra)
library(ggplot2)
})
#determining optimal number of clusters by elbow method
opt_clust <- fviz_nbclust(scaled_df, kmeans, method = "wss")
opt_clust
#Kmeans
set.seed(23200711)
kmeans_clust <- kmeans(scaled_df, centers = 4, nstart = 25)
#means of each cluster
aggregate(USArrests, by = list(cluster = kmeans_clust$cluster), mean)
#clusters plot
fviz_cluster(kmeans_clust, data = scaled_df, ellipse.type = "convex", ggtheme = theme_minimal())
#calculating euclidean dist
df_dist <- dist(scaled_df)
#hierarchical clustering
hierar_clust <- hclust(df_dist)
#dendrogram
plot(hierar_clust)
